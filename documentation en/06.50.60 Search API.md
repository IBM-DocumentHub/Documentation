### Search API

#### Search Initialization

Search initialization json can be defined in catalog.json or can be set with patch catalog API. Search initialization is saved in the catalog so you don't have to call it again unless you want to change it.

Example of search initialization in catalog.json:

```
catalog.json
{
  ...
  "search": {
    "fields": [
      "document.title",
      "document.tags"
    ],
    "filters": [
      "document.category"
      "document.country.name Country"
    ]
  }
}
```
In this catalog, the search will run on the document.title and document.tags fields and the filters count and labels will be returned for document.category and document.country.name.
The filter labels are optional and can be defined in the same string as the filter key, separated by space.

![Search](_attachments/search10.png)


#### Search History

Returns the list of all searches ran on this catalog.


#### Simple Search

Search text in the metadata fields defined in search initialization. Returns the matching documents in the relevance order.


#### Advanced Search

Search, filter, sort, pagination and filters count in a single API request. All fields are optional.

```
{
  "search": "ibm",
  "filter": {
    "or": {},
    "and": {
      "document.language": "en",
      "document.type": [
        "course",
        "article"
      ],
      "document.cost": {
        "gt": 0,
        "lte": 1000
      }
    }
  },
  "sort": {},
  "limit": {
    "from": 0,
    "to": 99
  },
  "fuzzy": false,
  "returnFiltersCount": false,
  "returnFilterLabels": false,
  "returnFields": [
    "document",
    "catalog"
  ]
}
```

This json query searches "ibm" in all documents than filters the documents by:
```
language="en" and (document.type="course" or document.type="article") and (document.cost>0 and document.cost<=1000)
```



If the value of filtered field is an object then the following operators can be used inside that object:
```
eq, ne, gt, lt, gte, lte, regex, regexi
```

Is also possible to use the "and" operator inside "or":
```
"filter": {
        "or": {
            "document.owner": "john.doe@email.com",
            "and": {
                "document.published": true,
                "document.langcode": "en"
            }
        }
    }
```

"and" field can also be an array of objects:
```
    "and": [
      {
        "document.tags": "cloud"
      },
      {
        "document.tags": "ibm"
      },
      {
        "document.status": [
          "Active",
          "Published"
        ]
      }
    ]
```

This filter will translate to:
```
document.tags="cloud" and document.tags="ibm" and (document.status="Active" or document.status="Published")
```


If sort is missing, the default sort is by relevance. Possible values for sort are: "asc" and "desc".

If fuzzy is true and there is no result found on the regular search, then a fuzzy search will be run and the fuzzy search results will be returned.
This is useful when there is a typo in the search term, and instead of returning an empty list it will return fuzzy match results.

If the returned results are from a fuzzy search, the field fuzzy: true will be added in the response object.


#### Search Suggestions

Search text in the metadata fields defined at search initialization. Returns the search suggestions based on the user input so far.


#### Filters Count

Returns the list of all values for each filter field defined in search initialization, along with the count for each value.

![Search](_attachments/search11.png)
