## Create a React + DocumentHub CMS + IBM SSO application


### Create React application

Follow the steps from reactjs.org website: https://reactjs.org/docs/create-a-new-react-app.html#create-react-app

```
npx create-react-app my-app
cd my-app
npm start
```


### Install DocumentHub

To install the DocumentHub Javascript package, run the following command in your React application folder (my-app):

```
npm i documenthub
```


### Load document from GitHub

Replace the content of the file src/App.js with the following:

```
import logo from './logo.svg';
import './App.css';
import { useEffect, useState } from 'react';
import documenthub from 'documenthub'

function App() {

  const [fetchedData, setFetchedData] = useState({});
  useEffect(() => {
    const getData = async () => {
      var data = await documenthub.getDocument('IcCVI6RO', 'documentation', 'en')
      setFetchedData(data);
    };
    getData();
  }, []);

  console.log("data: ", fetchedData);

  return (
    <div className="App">
      <header className="App-header">
        <img src={logo} className="App-logo" alt="logo" />
								
        <p>DocumentHub can read content from GitHub with a simple get function.</p>
        <p>Let's read this <a href="https://github.com/IBM-DocumentHub/Documentation/blob/master/documentation%20en/document.json">document.json</a> file:</p>
        <pre style={{"width": "80%", "textAlign": "left", "whiteSpace": "pre-wrap"}}><small>{JSON.stringify(fetchedData.document, null, 2)}</small></pre>
				
      </header>
    </div>
  );
}

export default App;

```

Save and run the application:

```
npm start
```


### Add IBMid SSO

To add IBMid SSO to our React application, a single line of code is required at the beginning of our code:

```
documenthub.ensureIBMidLogin('demo')
```

After the SSO login the user token will be stored as a cookie and the browser will return to http://localhost:3000/

Let's show the current user token in our app. Replace App.js with the following:

```
import logo from './logo.svg';
import './App.css';
import { useEffect, useState } from 'react';
import documenthub from 'documenthub'

documenthub.ensureIBMidLogin('demo')
const userToken = documenthub.getTokenCookie()

function App() {

  const [fetchedData, setFetchedData] = useState({});
  useEffect(() => {
    const getData = async () => {
      var data = await documenthub.getDocument('IcCVI6RO', 'documentation', 'en')
      setFetchedData(data);
    };
    getData();
  }, []);

  console.log("data: ", fetchedData);

  return (
    <div className="App">
      <header className="App-header">
        <img src={logo} className="App-logo" alt="logo" />

        <p>Logged user's token:</p>
        <pre style={{"width": "80%", "textAlign": "left", "whiteSpace": "pre-wrap"}}><small>{JSON.stringify(parseJwt(userToken), null, 2)}</small></pre>

        <p>DocumentHub can read content from GitHub with a simple get function.</p>
        <p>Let's read this <a href="https://github.com/IBM-DocumentHub/Documentation/blob/master/documentation%20en/document.json">document.json</a> file:</p>
        <pre style={{"width": "80%", "textAlign": "left", "whiteSpace": "pre-wrap"}}><small>{JSON.stringify(fetchedData.document, null, 2)}</small></pre>

      </header>
    </div>
  );
}

export default App;

function parseJwt (token) {
  var base64Url = token.split('.')[1];
  var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
  var jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
    return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
  }).join(''));

  return JSON.parse(jsonPayload);
};
```

We created a React application with SSO and DocumentHub CMS which can access content from any GitHub repository.

You can now manage your content in GitHub and load it in your application. You can also update content in GitHub from your application, the same as you do with a database.
